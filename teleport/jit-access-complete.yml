# Teleport: Complete Just-In-Time (JIT) Access System
# Zero Trust with Approval Workflow + Auto-Expiry
# Enterprise Security Lab | Manjula Wickramasuriya

---
kind: role
version: v7
metadata:
  name: jit-requester
spec:
  options:
    max_session_ttl: 12h
  allow:
    request:
      roles: ["jit-dev-access", "jit-db-access"]
      search_as_roles: ["jit-dev-access", "jit-db-access"]
    logins: ["readonly"]

---
kind: role
version: v7
metadata:
  name: jit-approver
spec:
  allow:
    review_requests:
      roles: ["jit-dev-access", "jit-db-access"]

---
kind: role
version: v7
metadata:
  name: jit-dev-access
spec:
  options:
    max_session_ttl: 2h
    pin_source_ip: true
    require_session_mfa: true
    request_access: always
  allow:
    logins: ["ubuntu"]
    node_labels:
      env: "dev"
